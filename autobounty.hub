-- Auto Bounty & Skill Menu UI
-- By ChatGPT

-- Load Rayfield
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

-- ====== SERVICES ======
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- ====== SETTINGS ======
local settings = {
    Groups = {
        Melee = {Enabled = false, Keys = {Z=false,X=false,C=false}},
        Fruit = {Enabled = false, Keys = {Z=false,X=false,C=false,V=false,F=false}},
        Sword = {Enabled = false, Keys = {Z=false,X=false}},
        Gun   = {Enabled = false, Keys = {Z=false,X=false}},
    }
}

-- ====== FUNCTION DÙNG CHIÊU ======
local function tryUseAbility(key)
    local char = LocalPlayer.Character
    if char then
        local tool = char:FindFirstChildOfClass("Tool")
        if tool then
            pcall(function() tool:Activate() end)
            print("Dùng tool với phím", key)
        end
    end

    local remoteFolder = ReplicatedStorage:FindFirstChild("Remotes")
    if remoteFolder then
        for _, r in pairs(remoteFolder:GetDescendants()) do
            if r:IsA("RemoteEvent") then
                pcall(function()
                    r:FireServer("UseSkill", key)
                    r:FireServer(key)
                end)
            end
        end
        print("Fired remote cho key:", key)
    end
end

-- ====== WINDOW ======
local Window = Rayfield:CreateWindow({
    Name = "Auto Bounty Skills Menu",
    LoadingTitle = "Run script",
    LoadingSubtitle = "Script SDVT Team",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "AutoBountyMenu",
        FileName = "cfg"
    }
})

-- ====== TAB ======
local Tab = Window:CreateTab("Setting", 11602940797)

-- ====== HÀM TẠO NHÓM CON ======
local function createGroup(tab, groupName, keys)
    -- Toggle chính
    local mainToggle = tab:CreateToggle({
        Name = groupName,
        CurrentValue = false,
        Callback = function(v)
            settings.Groups[groupName].Enabled = v
            -- show/hide toggles con
            for _,toggle in pairs(settings.Groups[groupName].SubToggles or {}) do
                toggle.Visible = v
            end
        end
    })

    -- Tạo toggles con (ẩn lúc đầu)
    settings.Groups[groupName].SubToggles = {}
    for _,k in ipairs(keys) do
        local sub = tab:CreateToggle({
            Name = "Use " .. k,
            CurrentValue = false,
            Callback = function(v)
                settings.Groups[groupName].Keys[k] = v
                if v then tryUseAbility(k) end
            end
        })
        sub.Visible = false
        table.insert(settings.Groups[groupName].SubToggles, sub)
    end
end

-- ====== TẠO NHÓM ======
createGroup(Tab,"Melee",{"Z","X","C"})
createGroup(Tab,"Fruit",{"Z","X","C","V","F"})
createGroup(Tab,"Sword",{"Z","X"})
createGroup(Tab,"Gun",{"Z","X"})
